# å“åº”

## å“åº”å¯¹è±¡

æ§åˆ¶å™¨å°å°è¿”å›ä¸€ä¸ªå“åº”å¯¹è±¡ï¼Œä¸­é—´ä»¶å¯èƒ½é€‰æ‹©æ€§è¿”å›ä¸€ä¸ªå“åº”å¯¹è±¡ã€‚

```python
# å¸¸è§„å“åº”
from sanic import HTTPResponse, Sanic

app = Sanic("TestApp")

@app.route("")
def handler(_):
    return HTTPResponse()
```

## å¯¹è±¡æ–¹æ³•

### Text

```python
# Content-Type: text/plain; charset=utf-8
from sanic import text

@app.route("/")
async def handler(request):
    return text("Hi ğŸ˜")
```

### HTML

```python
# Content-Type: text/html; charset=utf-8
from sanic import html

@app.route("/")
async def handler(request):
    return html('<!DOCTYPE html><html lang="en"><meta charset="UTF-8"><div>Hi ğŸ˜</div>')
```

### JSON

```python
# Content-Type: application/json
from sanic import json

@app.route("/")
async def handler(request):
    return json({"foo": "bar"})
```

é»˜è®¤ä½¿ç”¨`ujson`ï¼Œå¦‚éœ€è°ƒæ•´

```python
from sanic import json
from ujson import dumps

json({"foo": "bar"}, dumps=dumps)  # ç‰¹å®šè°ƒæ•´
app = Sanic(..., dumps=dumps)  # å…¨å±€è°ƒæ•´
```

### File

```python
# Content-Type: N/A
from sanic import file

@app.route("/")
async def handler(request):
    return await file("/path/to/whatever.png")

# ç‰¹å®šå£°æ˜ç±»å‹
file("/path/to/whatever.png", mime_type="image/png")
# è¦†å†™æ–‡ä»¶å
file("/path/to/whatever.png", filename="super-awesome-incredible.png")
```

### File Streaming

å¯¹äºå¤§å‹æ–‡ä»¶ï¼Œè¯·ç»“åˆä¸Šè¿°æ–‡ä»¶å’Œæµåª’ä½“

```python
# Content-Type: N/A
from sanic.response import file_stream

@app.route("/")
async def handler(request):
    return await file_stream("/path/to/whatever.mp4")

```

### Redirect

```python
# Content-Type: text/html; charset=utf-8
from sanic import redirect

@app.route("/")
async def handler(request):
    return redirect("/login")
```

### Raw

æ— éœ€ç¼–ç bodyå³å¯å“åº”

```python
# Content-Type: application/octet-stream
from sanic import raw

@app.route("/")
async def handler(request):
    return raw(b"raw bytes")
```

### Empty

```python
# Content-Type: N/A
from sanic import empty

@app.route("/")
async def handler(request):
    return empty()
```

## æ›´æ–°çŠ¶æ€

```python
@app.post("/")
async def create_new(request):
    new_thing = await do_create(request)
    return json({"created": True, "id": new_thing.thing_id}, status=201)

```

## jsonä¿®æ”¹

v22.12å¼€å§‹ï¼Œ`sanic.json`è¿”å›äº†`HTTPResponse`çš„å­ç±»`[sanic.response.types.JSONResponse`ï¼Œæä¾›äº†æ–¹ä¾¿çš„jsonå¤„ç†æ–¹æ³•å¯ä»¥ä½¿ç”¨

```python
from sanic import json

# dict
resp = json({"foo": "bar"})
resp.raw_body = {"foo": "bar", "something": "else"}
resp.set_body({"foo": "bar", "something": "else"})
resp.update({"something": "else"})
resp.pop("something")
resp.raw_body.update({"something": "else"})  # NG


# list
resp = json(["foo", "bar"])
resp.raw_body = ["foo", "bar", "something", "else"]
resp.extend(["something", "else"])
resp.append("something")
resp.append("else")
resp.pop("else")
resp.raw_body.append("something")  # NG

# aw Python object is stored on the JSONResponse object as raw_bodyï¼Œæ‰€ä»¥ä¸è¦æ”¹åŠ¨raw_body
```

