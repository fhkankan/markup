# 模块

python默认安装仅包含基本或核心模块，启动时也仅加载了基本模块，在需要时再显式地导入和加载标准库和第三方扩展库。

```
# 显示所有预加载模块的相关信息
sys.modules.items()

# 查看编译仅Python解释器的模块名字
sys.builtin_module_names
```

当以模块形式导入.py或.pyw源文件时，系统会自动检查`__pycache__`文件夹找那个是否存在相应的.pyc文件，若有且签名一致则自动从.pyc文件导入以提高加载速度，若源文件具有比.pyc文件更新的签名，那么导入时会自动重新生生.pyc文件。

需要注意的是，若源文件不存在，导入时不会检查`__pycache__`文件夹。因此，若想实现无源码部署，应该吧所有.pyc文件放到源文件的文件夹中而不是`__pycache__`文件夹中

## 模块制作

```
# 模块是一个包含所有你定义的函数和变量的文件，其后缀名是.py。模块可以被别的程序引入，以使用该模块中的函数等功能。这也是使用 python 标准库的方法。

# 模块中存在的类型
# 类/函数/全局变量/局部变量

# 模块中希望被引用的部分
# 只针对 from...import*有效
# _xxx的变量、函数、类不会被导入
# 添加__all__=['希望被引用的函数名或者全局变量名或者类名']
# 若无限定，则全部可被引用



# 测试模块
# 只在本模块中使用，不被外部引用
# 添加if __name__ == '__main__':测试主函数名(参数）
# 若无判断条件，则不仅在本类中运行，被引用时也会运行

# 创建时注意
# 模块名要遵循Python变量命名规范，不要使用中文、特殊字符；
# 模块名不要和系统模块名冲突，最好先查看系统是否已存在该模块，检查方法是在Python交互环境执行import abc，若成功则说明系统存在此模块。
```

## 模块引用

一般建议每个import语句只导入一个模块，且按照标准库、扩展库、自定义库的顺序导入

```
import ...
# 需要把命令放置顶端
# 一个模块可以被导入任意多次，但是只会被加载一次。不存在消耗内存问题
# 导入模块的所有信息
# 调用格式
# 模块名.函数名 / 模块名.类名 / 模块名.全局变量名


from ... import ...
# 如果只想导入模块的一个变量或者函数或者类
# 调用格式
# 函数名/类名/全局变量名
# 通过这种方式引入，调用函数时只能给出函数名，不能给出模块名，
# 当两个模块中含有相同名称函数的时候，后面一次引入会覆盖前一次引入。

from ... import *
# 导入一个模块中通过__all__变量指定的的所有对象
# 调用格式
# 函数名/类名/全局变量名
# 不建议使用：命名空间混乱、代码理解和维护不易

from ... import ...as 新名字
# 当模块名较长或为了防止和本模块中的名字冲突，可对模块进行重命名

from imp import reload
模块被导入后，模块内容更新，重新导入需用reload(模块名)
```

## 模块的路径

搜索

```
导入一个模块，Python解析器对模块位置的搜索顺序是：
1、当前目录
2.sys模块的sys.path变量所指定的目录
2.若是还未找到，抛异常提示模块不存在

模块搜索路径存储在system模块的sys.path变量中。变量里包含当前目录，PYTHONPATH和由安装过程决定的默认目录。
# Python则搜索在shell变量PYTHONPATH下的每个目录。
# 默认路径。UNIX下，默认路径一般为/usr/local/lib/python/

# 导入模块时的查询路径
import sys
sys.path
```

添加

```
添加自己的搜索目录
# 方法一：修改sys.path，添加要搜索的目录
import sys
sys.path.append('路径')
sys.path.insert(0, '路径') # 优先搜索
# 方法二：设置环境变量PYTHONPATH
该环境变量的内容会被自动添加到模块搜索路径中。设置方式与设置Path环境变量类似。
```

# 包

通过python程序的`__name__`属性可以识别程序的使用方式，每个python脚本运行时都会有一个`__name__`属性，如果脚本作为模块被导入，则其`__name__`属性的值被自动设置为模块名；若是脚本作为脚本直接运行，则其`__name__`属性值被自动设置为字符串`__main__`

## 制作

```
# 包是一种管理Python模块命名空间的形式，采用"点模块名称"。
# 由__init__.py和其他模块构成的文件夹

__init__.py
# 可以是一个空文件，仅用于表示当前文件夹是一个包
# python3中此文件可删除，python2中不可删除
# 可添加添加__all__=['模块名']，确定可被引用的模块，只针对 from...import*有效
```

## 引用

```
# import ...

# from ... import ...

# from ... import *
```

