# 异步实现

`peewee_async`

[文档](https://peewee-async.readthedocs.io/en/latest/)

## 查

### get

```python
# 不能执行
await mgr.execute(PurchaseCompany.get(PurchaseCompany.company_id == comp_id))

# 不存在时返回对象为空列表, 存在时obj[0]是字典
comp_obj = await mgr.execute(PurchaseCompany.select().where(PurchaseCompany.company_id == comp_id).dicts())

# 不存在时触发DoesNotExist,存在时是model对象
comp_obj = await mgr.get(PurchaseCompany, company_id=comp_id)
```

### select

```python
# 存在时obj[0]是字典， 不存在是
comp_counts = await mgr.execute(PurchaseCompany.select(fn.COUNT(PurchaseCompany.company_id).alias("count")).dicts())
# 返回行数
comp_counts = await mgr.count(PurchaseCompany.select().where(PurchaseCompany.company_id > 0))
# 返回字典组成的列表
comp_obj = await mgr.execute(PurchaseCompany.select().paginate(page_no, per_page).dicts()
```

## 增

### create

```python
 # 不能执行
 await mgr.execute(PurchaseCompany.create(company_name=name, aes_key=aes, app_secret_key=sec))
 # 执行成功，返回影响行数
 await  mgr.execute(PurchaseCompany.insert(company_name=name, aes_key=aes, app_secret_key=sec))
 # 执行成功，返回Model对象
 await mgr.create(PurchaseCompany, company_name=name, aes_key=aes, app_secret_key=sec)
```

### bulk

```

```



## 改

```python
# 执行成功，返回影响的行数
await mgr.execute(PurchaseCompany.update(emp_list=comp_obj.emp_list).where(PurchaseCompany.company_id == comp_id))

# 执行成功，返回影响的行数，与get配合使用
await mgr.update(comp_obj)
```



## 删

