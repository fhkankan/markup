# 数学运算与模拟

## 数学函数

```R
exp()	# 以自然常数e为底的指数函数
log()	# 自然对数
log10()	# 以10为底的常用对数
sqrt()	# 平方根
abs()	# 绝对值
sin()/cos()	# 三角函数
min()/max()	# 向量的最小、最大值
which.min()/which.max()	# 向量的最小、最大元素的位置索引
pmin()/pmax()	# 把多个等长度的向量按与元素逐个对比，返回所有向量的第k个元素中最小（最大）的值
sum()/prod()  # 把一个向量的所有元素求和（求积）
cumsum()/cumprod()	# 把一个向量的前k个元素累计求和（求积）
round()/floor()/ceiling()	# 分别四舍五入取整、向下取整、向上取整
factorial()	# 阶乘
```

微分$\frac{d}{dx}e^{x^2}$

```R
D(expression(exp(x^2)), "x")
```

积分$\int_0^1x^2dx$

```R
integrate(function(x) x^2, 0, 1)
```

## 统计

### 统计量

```R
summary()	# 汇总统计量
mean()		# 均值
median()	# 中位数
min()		# 最小值
max()		# 最大值
range()		# 最小值、最大值
diff()		# 差值值域
IQR()		# Q1和Q3之差四分位距
quantile()	# 五数汇总：最小值、Q1(第一四分位数)、Q2(中位数)、Q3(第三四分位数)、最大值
var()		# 方差
sd()		# 标准差
```

### 分布函数

大部分的统计分布函数在R里都有实现。这些函数名都有一套统一的前缀

```
d对应概率密度函数或概率质量函数
p对应累计分布函数
q对应分布的分位数
r对应随机数生成函数
```

常用统计分布函数

| 分布     | 概率密度函数/概率质量函数 | 累计分布函数 | 分位数     | 随机数     |
| -------- | ------------------------- | ------------ | ---------- | ---------- |
| 正态分布 | `dnorm()`                 | `pnorm()`    | `qnorm()`  | `rnorm()`  |
| 卡方分布 | `dchisq()`                | `pchisq()`   | `qchisq()` | `rchisq()` |
| 二项分布 | `dbinom()`                | `pbinom()`   | `qbinom()` | `rbinom()` |

示例

```R
# 生成1000个自由度为2的卡方随机变量，求其平均值
mean(rchisq(1000, df=2))
# 自由度为2的卡方分布的95%分位数
qchisq(0.95, 2)
# 自由度为2的卡方分布的50%分位数和95%分位数
qchisq(c(0.5, 0.95), df=2)
```

## 排序

```R
x <- c(13, 5, 12, 5)
y <- sort(x)  # 返回排好序的序列

y_index <- order(x)  # 返回排好序后的值在原序列的原索引
y_rank <- rank(x)  # 返回向量中每一个元素的排位
```

## 线性代数运算

```R
# 向量乘以标量
x <- c(1,2,3,4)
y <- 2 * x

# 向量内积
y <- crossprod(1:3, c(5, 12, 13))

# 矩阵乘法
a %*% b

# 其他线性代数运算函数
t()			# 矩阵的转置
qr()		# QR分解
chol()		# Cholesky分解
det()		# 矩阵的行列式值
eigen()		# 矩阵的特征值和特征向量
diag()		# 从方阵中提出对角矩阵，有利于从协方差矩阵中得到方差和构建对角矩阵
sweep()		# 数值分析批量元算符
```

## 集合运算

```R
union(x, y)  	# 集合x和y的并集
intersect(x, y) # 集合x和y的交集
setdiff(x, y)	# 集合x和y的差集
setequal(x, y)	# 检验集合x和y是否相等
c%in%y			# 成员，检验c是否为集合y中的元素
choose(n, k)    # 从含有n个元素的集合中选取含有k个元素的子集的数目
```

## 模拟

- 内置的随机变量发生器

```R
rbinom()	# 生成服从二项分布或伯努利分布的随机变量
rnorm()		# 生成正态分布
rexp()		# 生成指数分布
runif()		# 生成均匀分布
rgamma()	# 生成伽马分布
rpois()		# 生成泊松分布
```

- 重复运行时获得相同的随机数流

```R
set.seed(888)
```

