# 矩阵与数组

矩阵(matrix)是一种特殊的向量，包含两个附加的属性：行数和列数。所以矩阵也和向量一样，有模式的概念，如数值型和字符型。

数组(array)是R中更一般的对象，矩阵是数组的一个特殊情形。数组可以是多维的。如一个三维数组可以包含行、列、层。

## 创建矩阵

矩阵的行和列的下标都是从1开始，矩阵a左上角的元素记为`a[1,1]`。矩阵在R中是按列存储的，也就是先存储第1列，再存储第2列，以此类推。

使用`matrix()`创建初始化

```R
y <- matrix(c(1,2,3,4), nrow=2, ncol=2)
```

为元素赋值创建

```R
y <- matrix(nrow=2, ncol=2)
y[1, 1] <- 1
y[2, 1] <- 2
y[1, 2] <- 3
y[2, 3] <- 4
```

默认按列存储和展示，`byrow=T`可以使矩阵元素展示按行排列，但是存储还是按列存储

```R
y <- matrix(c(1,2,3,4), nrow=2, ncol=2, byrow=T)
```

## 矩阵属性

```R
z <- matrix(1:8, nrow=4)

class(z)  # 类名
attributes(z)  # 属性
dim(z)  # dim属性
nrow(z)  # 行数
ncol(z)  # 列数
```

由于矩阵降维后可能为向量，导致一些矩阵运算异常，所以应避免意外降维。

## 矩阵运算

### 线性代数

````R
y <- matrix(c(1,2,3,4), nrow=2, ncol=2)
# 矩阵相乘
y %*% y
# 矩阵数量乘法
3 * y
# 线性代数
y + y
````

### 矩阵索引

```R
y <- matrix(c(1,2,3,4,5,6), nrow=3, ncol=2)

# 获取元素
y[1:2,]
y[1,2]

# 元素修改
y[c(1,3),] <- matrix(c(1,1,8,12), nrow=2)

x <- matrix(nrow=3, ncol=3)
y <- matrix(c(4, 5, 2, 3), nrow=2)
x[2:3, 2:3] <- y

# 删除元素
y <- matrix(c(1,2,3,4,5,6), nrow=3, ncol=2)
y[-2,]
```

### 元素筛选

```R
x <- matrix(c(1,2,3,4,5,6), nrow=3, ncol=2)
"""
     [,1] [,2]
[1,]    1    4
[2,]    2    5
[3,]    3    6
"""
x[x[,2]>=3, ]
"""
    [,1] [,2]
[1,]    2    5
[2,]    3    6
"""

z <- c(5, 12, 13)
x[z %% 2 == 1, ]
"""
     [,1] [,2]
[1,]    1    4
[2,]    3    6
"""
```

## 对行列操作

### 调用函数

`apply(),tapply(),lapply()`函数允许用户在矩阵的各行或各列上调用指定的函数。

```R
apply(m, dimcode, f, fargs)
# 参数
# m是一个矩阵，dimcode是纬度编号，若取值为1代表对每一行应用函数，若取值为2代表对每一列应用函数
# f是应用在行或列上的函数，fargs是f的可选参数集
```

示例

```R
x <- matrix(c(1,2,3,4,5,6), nrow=3, ncol=2)
apply(x, 2, mean)  # 2 5

f <- function(x) x/c(2,8)
y <- apply(x, 1, f)  # 第一行的计算结果构成apply()函数输出结果的第一列
"""
    [,1]  [,2] [,3]
[1,]  0.5 1.000 1.50
[2,]  0.5 0.625 0.75
"""
```

### 增删行列

```R
# 向量改变大小
x <- c(12, 5, 13, 16, 8)
x <- c(x, 20)  # append 20
x <- c(x[1:3], 20, x[4:6])  # insert 20
x <- x[-2:-4]  # delete 索引为2～4

# 矩阵改变大小
m <- matrix(1:6, nrow=3)
m <- m[c(1,3),]  # 1,3行保留

one <- c(1,2)
z <- cbind(one, m)  # 增加列
z <- cbind(m, one)
z <- rbind(one, m)  # 增加行
```

### 行列命名

```R
m <- matrix(1:6, nrow=3)
# get
colnames(m)
rownames(m)
# set
colnames(m) <- c("a", "b")
rownames(m) <- c("e", "f", "g")
m

# 使用
m[, "a"]
```



