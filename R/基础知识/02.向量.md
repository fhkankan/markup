# 向量

## 概述

```R
# 标量与向量
在其他语言中，标量与向量不同，但在R中标量被当做一元向量

同一向量中的所有元素必须是同一模式，可以是整型、数值型、字符型、逻辑型、复数型等
typeof(x)

# 添加/删除向量元素
与C的数组类似，R中向量是连续存储，因此不能插入或删除元素。这跟python不同，向量的大小在创建时已经确定，若想修改，需要重新给向量赋值
x <- c(1,2,3,5)
x <- c(x[1:3],4,x[4])

# 获取向量长度
x <- c(1,2,3)
length(x)

# 数据与矩阵
数组与矩阵实际上都是向量，只是他们还是有额外的类属性
```

## 声明

```R
# 不同于C,R中不需要声明变量
z <- 3
# 若引用向量中特定的元素，需事先告诉R
y <- vector(length=2)
y[1] <- 5
y[2] <- 6
或：
y <- c(5,6)
```

## 循环补齐

对两个向量进行运算时，若要求两个向量具有相同的长度，R会自动循环补齐长度较短的向量

```R
c(1,2,3) + c(1,1,1,1,1)
# =>
c(1,2,3,1,2) + c(1,1,1,1,1)
2,3,4,2,3
```

## 向量运算

### 运算符

```
# R是一种函数式语言，运算符也是函数
+ ：按子元素逐一相加
* ：按子元素逐一相乘
/  :按子元素逐一相除
%% :按子元素逐一求余
```

### 向量索引

向量的索引从1开始

```R
# 索引向量的格式：
向量1[向量2]
# 结果
向量1中索引为向量2的那些元素
# 负数的下标表示剔除相应的元素

# 例子
y <- c(2,3,4)
y[1]  # 2  

y <- c(2,3,4,5)
y[c(1,2)] # 2 3

z <- c(1,2,3)
z[-1]  # 2,3
```

### 快捷创建

```R
# :运算符,间隔为1
>5:8	# 结果5,6,7,8

# seq(),等差数列
>seq(from=12,to=30,by=3)
>seq(from=1,to=2,length=10)

# rep(),重复向量常数
rep(x,times)
>rep(2,3) # 结果2,2,2
>rep(c(1,2,3),2) # 结果1,2,3,1,2,3

# all(),参数全部为True,则为True
# any()，参数有一为True,则为True
x <- 1:10
any(x>90)
all(x>0)
```

## 空值

```R
# NA表示缺失值，存在但未知
# 忽略NA,使用na.rm=T，NA的类型可由上下文判断
x <- c(88, NA, 12, 168)
mean(x)
mean(x, na.rm=T)

x <- c(5, NA, 12)
mode(x[1])
mode(x[2])

u<-NA
length(u)
# NULL表示不存在的值
x <- c(88, NULL, 12, 168)
mean(x)

z<-NULL
for(i in 1:10) if(i%%2==0) z<-c(z, i)

 v<-NULL
length(v)
```

## 向量化运算符

向量化即应用到向量上的函数，实际上应用在其每一个元素上，可以提交

```R
# 向量输入，向量输出
# +、-、*、超越函数(平方根，对数，三角函数等)、内置函数(round()等)
u<-c(1,2,3)
v<-c(4,5,6)
u>v  # >是向量化运算符
w <- fucniton(x) return(x+1)  # +是向量化运算符
w(u)

# 向量输入，矩阵输出
# 函数的返回值就是向量，此时做矩阵输出表示较直观
z12 <- function(z) return (c(z, z^2))
sapply(1:8, z12)
```

## 筛选

使用筛选索引

```R
z <- c(5, 2,-1,8)
w <- z[z*z > 8]
```

使用`subset()`函数

```R
# 与筛选索引区别在处理NA上
x <- c(6, 1:3, NA, 12)
x[x>5]  # 6 NA 12
subset(x, x>5)  # 6 12
```

使用`which()`函数

```R
# 提取满足条件元素所在的位置
z <- c( 5, 2, -3, 8)
which(z*z>8)  # 1 3 4
```

## 向量化ifelse()函数

除了多数语言中常见的`if-then-else`结构，R还有一个向量化版本`ifelse()`

```R
ifelse(b, u, v)
# 参数：b是布尔值向量， u,v是向量
# 返回：向量，如果b[i]为真，则返回值的第i个元素为u[i]，如果b[i]为假，则返回值的第i个元素为v[i]
```

示例

```R
x < 1:5
y <- ifelse(x%%2==0, 5, 12)  # 12 5 12 5 12
```

## 相等

测试两个向量是否相等，使用`==`是不行的，因为在R中，`==`是一个函数，对于向量化`x==y`是将函数应用到x和y的每一组元素上。

```R
a <- 1:3
b <- c(2,3,4)
a == b  # False False False

# all()
x <- 1:3
y <- c(1,2,3)
x == y  # True True True
all(x==y)  # True

# identical()
identical(x, y)  # 判断两个对象是否完全一样
typeof(x)  # integer
typeof(y)  # double
```

## 元素名称

可以使用`name()`给向量中的元素命名，或查询向量元素的名称

```R
x <- c(1,2,4)
names(x)  # NULL
# 命名
names(x) <- c("a", "b", "c")
names(x)  # a b c
# 删除命名
nmes(x) <- NULL
# 引用元素
x <- c(1,2,4)
names(x) <- c("a", "b", "c")
x["b"]
```

