# vim

## 基础

启动vim

```
在命令行窗口中输入以下命令即可
vim 直接启动vim
vim filename.txt 打开vim并创建名为filename的文件
```

工作模式

```
普通模式：ESC键
插入模式：i,a,o,c,r，s
末行模式：：

进入插入模式
i 插入光标前一个字符
I 插入行首
a 插入光标后一个字符
A 插入行末
o 光标下新开一行，插入行首
O 光标上新开一行，插入行首
```

保存与退出

```
:w 保存，不退出
:wa 保存，不退出

:q 退出
:wq 保存退出：
:x 简单退出
:q! 不保存退出
:e! 放弃所有修改，并打开原来文件

zz 普通模式下保存并退出
ctr+z 不保存后台运行
fg从后台唤醒
```

## 命令历史

```
以:和/开头的命令都有历史纪录，可以首先键入:或/然后按上下箭头来选择某个历史命令。
```
## 窗口

```
:split或new 打开一个新窗口，光标停在顶层的窗口上
:split file或:new file 用新窗口打开文件
split打开的窗口都是横向的，
:sv <filename> 横向打开窗口
:vs <filename> 可以纵向打开窗口。

Ctrl+ww 移动到下一个窗口
Ctrl+wj 移动到下方的窗口
Ctrl+wk 移动到上方的窗口

关闭窗口
:close 最后一个窗口不能使用此命令，可以防止意外退出vim。
:q 如果是最后一个被关闭的窗口，那么将退出vim。
ZZ 保存并退出。
关闭所有窗口，只保留当前窗口
:only

录制宏
按q键加任意字母开始录制，再按q键结束录制（这意味着vim中的宏不可嵌套），使用的时候@加宏名，比如qa。。。q录制名为a的宏，@a使用这个宏。
```
## 文件

```
打开单个文件
vim file
同时打开多个文件
vim file1 file2 file3 ...
在vim窗口新建一个文件
:new file
在vim窗口中打开一个新文件
:open file
在新窗口中打开文件
:split file
切换到下一个文件
:bn
切换到上一个文件
:bp
查看当前打开的文件列表，当前正在编辑的文件会用[]括起来。
:args
打开远程文件，比如ftp或者share folder
:e ftp://192.168.10.76/abc.txt
:e \\qadrive\test\1.txt
```
## 缓冲区

```
Buffer 是内存中的一块缓冲区域，用于临时存放Vim打开过的文件
- （非活动的缓冲区）
a （当前被激活缓冲区）
h （隐藏的缓冲区）
% （当前的缓冲区）
# （交换缓冲区）
= （只读缓冲区）
+ （已经更改的缓冲区）
Ctrl + ^在当前文件和轮换文件间快速切换

# 查看buffer中文件列表
:buffers
:ls
:files
:buffers!  	# 列表外缓冲区

# 新窗口打开一个缓冲区
:sbuffer <编号>
:sbuffer <文件名> 

# 切换缓冲区
:buffer <编号>
:buffer <文件名>
:bnext			# 切换到下一个
:bprevious		# 切换到上一个
:blast			# 切换到最后
:bfirst			# 切换到第一个

# 维护缓冲区
:badd test5		# 增加缓冲区
:bdelete test4	# 删除缓冲区
:N,M bdelete	# 删除编号n~m的缓冲区
:bwipe			# 彻底删除缓冲区
```

## 执行shell命令

```
:!command
:!ls 					列出当前目录下文件
:!perl -c script.pl 	检查perl脚本语法，可以不用退出vim，非常方便。
:!perl script.pl 		执行perl脚本，可以不用退出vim，非常方便。
:suspend或Ctrl - Z 	   挂起vim，回到shell，按fg可以返回vim。
:!python3 %				在vim中执行python文件，%标识当前所编辑文件会被该文件名替换
```

## 帮助

```
:help or F1 显示整个帮助
:help xxx 显示xxx的帮助，比如 :help i, :help CTRL-[（即Ctrl+[的帮助）。
:help 'number' Vim选项的帮助用单引号括起
:help <Esc> 特殊键的帮助用<>扩起
:help -t Vim启动参数的帮助用-
：help i_<Esc> 插入模式下Esc的帮助，某个模式下的帮助用模式_主题的模式
：help E37 查看错误信息的帮助
超链接 帮助文件中位于||之间的内容是超链接，可以用Ctrl+]进入链接，Ctrl+o（Ctrl + t）返回
ZZ 退出帮助窗口，而不会退出vim
```

## 其他非编辑命令

```
. 重复前一次命令
:set ruler?　　查看是否设置了ruler，在.vimrc中，使用set命令设制的选项都可以通过这个命令查看
:scriptnames　　查看vim脚本文件的位置，比如.vimrc文件，语法文件及plugin等。
:set list 显示非打印字符，如tab，空格，行尾等。如果tab无法显示，请确定用set lcs=tab:>-命令设置了.vimrc文件，并确保你的文件中的确有tab，如果开启了expendtab，那么tab将被扩展为空格。
Vim教程
在Unix系统上
$ vimtutor
在Windows系统上
:help tutor

:syntax 列出已经定义的语法项
:syntax clear 清除已定义的语法规则
:syntax case match 大小写敏感，int和Int将视为不同的语法元素
:syntax case ignore 大小写无关，int和Int将视为相同的语法元素，并使用同样的配色方案


```

## 查看

确定当前位置

```
ctr+g 显示当前位置信息(ruler关闭情况下)
:set number 显示行号
:set nonumber 关闭行号
:set ruler 窗口右下角显示当前光标位置

{ 按段移动，上移
} 按段移动，下移
```

查看信息

```
:set number  # 查看行数
:set list    # 查看换行符和tab占位符
```



## 移动

计数+命令

```
在命令行模式下，
数字+命令 --->命令执行指定次数
```

字符移动

```
h 往左移动一位
j 往下移动一行
k 往上移动一行
l 往右移动一位
```
词移动

```
w 下一个词的词首
b 上一个词的词首
e  下一个词的词末
ge 上一个词的词末
```
移动至指定字符

```
fx 向右移动至本行x处
Fx 向左移动至本行x处
tx 向右移动至本行x前
Tx 向左移动至本行x前
； 命令重复
， 反向重复
```
移动至行首行尾

```
^ 光标回到所在行首(非空字符)
0 光标回到所在行最开始字符
$ 光标回到所在行末
```
移动到指定行

```
H 移动到视野头
M 移动到视野中
L 移动到视野尾
zt 移动到视野头
zz 移动到视野中
zb 移动到视野尾

gg 移动到文档开头
G 移动到文档末行行首
n gg 移动至文当第n行代码行首
n G 移动至文当第n行代码行首
50% 移动到文档50%内容处行首
```
括号匹配

```
% 括号匹配，适用于(),[],{}
```

文本行移动

```
>> 文本行右移
<< 文本行左移
```

滚屏

```
ctr+e 向下滚一行
ctr+y 向上滚一行
ctr+d 向下翻半屏
ctr+u 向上翻半屏
ctr+f 向下翻一屏
ctr+b 向上翻一屏
```
## 查找
```
/+字符 	  查找包含字符的内容
n 		    下一个
N			上一个
/text　　	  查找包含text，按n键查找下一个，按N健查找前一个。
?text　　	  查找包含text，反向查找，按n健查找下一个，按N健查找前一个。
/text\> 	查找以text结尾的内容
/\<text		查找以text开头的内容
/\<text\> 	查找text这个单词
光标+* 	  光标移动到该词上按*，相当于/搜索
光标+# 	  光标移动到该词上按#，相当于?搜索

/+正则表达式 特殊字符在查找时需要转义　　.*[]^%/?~$

# 与或非
/a.*b  # 查找包含a开头b结尾的字符串
/a|b   # 查找包含a或b的字符串

:set ignorecase　　	忽略大小写的查找
:set noignorecase　　	不忽略大小写的查找
:set hlsearch　　		高亮搜索结果，所有结果都高亮显示，而不是只显示一个匹配。
:set nohlsearch　　	关闭高亮搜索显示
:nohlsearch　　		关闭当前的高亮显示，如果再次搜索或者按下n或N键，则会再次高亮。
:set incsearch　　	逐步搜索模式，对当前键入的字符进行搜索而不必等待键入完成。
:set wrapscan　　		重新搜索，在搜索到文件头或尾时，返回继续搜索，默认开启。
:set nowrapsacan	  往后查找到文件结尾处停止，或往前查找到文件开头处停止
```
## 标记

```
'或" 	在vim中的行间跳转时，会自动记忆跳转位置，使用此命令可调至上一位置
crt+o 	跳至上一位置
crt+i	调制下一位置
:jumps	输出可跳往的位置的列表，最后一个标记用>标识
:marks	输出所有标记的列表

# 设置标记
m+[a~z]	可以在行首设定26个不可见的标记
# 跳转至标记
'+[a~z] 可以跳转至特定字母标记处行首

# 特殊标记
'	跳转前的贯标位置
"	最后编辑的贯标位置
[	最后修改的开始位置
]	最后修改的结束位置

```
# 改动

## 操作符+动作

```
操作符+动作 --->可以在文本上执行任何操作
```
## 重复

```
.		重复上一次的操作
```
## 选中

```
v		启动可视模式，单个字符
移动光标时，所经过的区域被高亮显示，可以执行操作符命令
V		启动可视模式，按行选择
ctr+v	启动列块可视模式，矩形文本选择
ggVG	普通模式下，全选


o		在可视模式下，o在选中文字的头尾处跳转，在列块可视模式下，o移动到了对角上	

多行添加
ctr+v
j
I
#(添加内容)
Esc
多行删除
ctr+v
j
d
```
## 删除

```
d  删除操作符(delete)
dd 删除当前行
dh 删除前一个字符
dj 删除上一行
dk 删除下一行
dl 删除当前字符， dl=x
d4w	删除光标后四个单词
d4e 删除光标后四个单词(包含最后一个字符)
d$ 删除当前字符之后的所有字符（本行）

kdgg 删除当前行之前所有行（不包括当前行）
jdG（jd shift + g）   删除当前行之后所有行（不包括当前行）
10d 删除当前行开始的10行。
D 删除当前字符至行尾。D=d$
:1,10d 删除1-10行
:11,$d 删除11行及以后所有的行
:1,$d 删除所有行

J(shift + j)　　删除两行之间的空行，实际上是合并两行。

```
## 修改
```
c		修改操作符(change)
cc		删除本行，保留缩进，进入插入状态
ch 		删除前一个字符,进入插入状态
cj		删除上一行，进入插入状态
ck 		删除下一行，进入插入状态
cl 		删除当前字符，进入插入状态
c2wbe	删除光标后的连个词并插入be这个单词
c$		修改到行尾，相当于d$+a
```
##大小写转换

```
# 单个字符的处理
~		切换光标所在位置的字符的大小写形式，大写转换为小写，小写转换为大写
3~		将光标位置开始的3个字母改变其大小写

# 文本的转换
gu		大写转小写
gU		小写转大写

ggguG	整篇文章大写转小写,gg：文件头，G：文件尾，gu：切换为小写
gggUG	整篇文章小写转大写,gg：文件头，G：文件尾，gU：切换为大写

1gU 	从光标所在行 往下一行都进行小写到大写的转换
gU0     从光标所在位置到行首，都变为大写
gU$     从光标所在位置到行尾，都变为大写
gUG     从光标所在位置到文章最后一个字符，都变为大写
gU1G    从光标所在位置到文章第一个字符，都变为大写

# 光标前后面的单词便会进行大小写转换
guw 、gue	
gUw、gUe
gu5w、gu5e	转换5个单词
gU5w、gU5e
```

## 单字符

```
x 		dl,删除光标下字符
3x 		删除当前光标开始向后三个字符
X 		dh,删除光标左边的字符
D		d$,删除到行尾
C		c$，修改到行尾
s		cl，修改一个字符
S		cc，修改一整行
r 		cl+esc,替换光标下的字符
Y		yy,拷贝一整行
```
## 替换

末行模式下

```
r：替换当前字符
R：替换当前行光标后的字符
ra 将当前字符替换为a，当期字符即光标所在字符。
s/old/new/ 用old替换new，替换当前行的第一个匹配
s/old/new/g 用old替换new，替换当前行的所有匹配
%s/old/new/ 用old替换new，替换所有行的第一个匹配
%s/old/new/g 用old替换new，替换整个文件的所有匹配
:10,20 s/^/    /g 在第10行知第20行每行前面加四个空格，用于缩进。
ddp 交换光标所在行和其下紧邻的一行。

```



## 剪切

```
正常模式下按v（逐字）或V（逐行）进入可视模式，然后用jklh命令移动即可选择某些行或字符，d 即可剪切
ndd 剪切当前行之后的n行。利用p命令可以对剪切的内容进行粘贴
:1,10d 将1-10行剪切。利用p命令可将剪切后的内容进行粘贴。
:1, 10 m 20 将第1-10行移动到第20行之后
```
## 复制

```
y		复制操作符(yank)
yy 		拷贝当前行
nyy 	拷贝当前后开始的n行
yw		拷贝一个单词(带空格)
ye		拷贝一个单词(不带空格)
y$		拷贝到行尾
正常模式下按v（逐字）或V（逐行）进入可视模式，然后用jklh命令移动即可选择某些行或字符，再按y即可复制
```
## 粘贴

```
p  		粘贴操作符(put)
p		在当前光标后粘贴,如果之前使用了yy命令来复制一行，那么就在当前行的下一行粘贴。
shift+p 		在当前行前粘贴
:1,10 co 20 	将1-10行插入到第20行之后。
:1,$ co $ 		将整个文件复制一份并添加到文件尾部。

ddp交换当前行和其下一行
xp交换当前字符和其后一个字符
```

## 剪贴板

```
剪贴板的操作：
1、gvim的菜单edit/copy，
转出：可视模式选中，edit/copy,将内容写入剪贴板
写入：edit/past,从剪贴板写入，可视模式下替换，插入下插入
2、命令（仅在支持剪贴板的vim中有效）
"*y		可视模式下拷贝选中行到剪贴板
"*yy	普通模式下拷贝一行
"*y3	普通模式下拷贝3行

"*p		粘贴进vim,普通模式写入，可视模式替换
```

## 注释

```
方法一：块选择模式
光标位于所有行的数据的最左侧
可视化模式下，选中要注释的行
# 插入注释
Ctr+v（win下ctr+q）,进入列模式，
I进入插入行首，输入注释符#，两次ESC退出
# 取消注释
Ctr+v（win下ctr+q）,进入列模式，
选中要删除的行首的注释符号，按d即可

方法二：替换命令
插入注释：
3,5 s/^/#/g 注释第3-5行
1,$ s/^/#/g 注释整个文档。
:%s/^/#/g 注释整个文档，此法更快。
取消注释：
3,5 s/^#//g 解除3-5行的注释
```

## 撤销

```
u：一步步撤销
U: 撤销对整行的操作
ctr+r：反撤销
```
